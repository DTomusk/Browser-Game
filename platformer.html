<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<canvas id="canvas" width="800" height="600"></canvas>

	<script type="text/javascript">
		var canvas;
		var ctx; 
		var fps = 24;
		// when in the air vy of any object increases by 0.5 every frame
		var g = 1;
		var xShift = 0;
		var yShift = 0;

		// load all objects into the scene and stuff
		window.onload = function() {
			canvas = document.getElementById('canvas');
			ctx = canvas.getContext('2d');


			// we want to load levels from somewhere, we want to have the initial states of the levels written 

			// the camera is the canvas, everything should translate when the camera moves 


			// initial objects, should be in its own place
			var tree = new Oak(70, 130);
			var player = new Actor(100, 100, 20, 20, [new Component(0,0,20,20,"grey")]);

			var level2 = new Level(500, 500, [],[],[],[],[]);

			var level = new Level(1200, 600, [], 
				[new Object(0, 500, 400, 100, [new Component(0,0,400,100,"blue")]), new Object(300, 480, 40, 40, [new Component(0,0,40,40,"DarkGoldenRod")])],[tree],[player],[new Door(200, 400, 100, 100, level2)]);

			var levels = [level];
			
			// the actual game 
			setInterval(function() {
				moveStuff(level);
				drawStuff(level,xShift,yShift);
			}, 1000/fps);


			// event listeners, mostly for key presses 
			window.addEventListener("keydown", function(evt) {
				switch(evt.keyCode) {
					case 37:
						player.vx = -5;
						if (xShift < 0) {
							xShift += player.vx;
						}
						break;
					case 39:
						player.vx = 5;
						if (xShift - level.width > 0) {
							xShift += player.vx;
						}
						break;
				}
			});

			window.addEventListener("keyup", function(evt) {
				switch(evt.keyCode) {
					case 39:
						if (player.vx > 0) {
							player.vx = 0;
						}
						break;
					case 37:
						if (player.vx < 0) {
							player.vx = 0;
						}
						break;
					case 32: 
						if (player.state == "ground") {
							player.vy -= 10;
							player.state = "air";
						}
						break;
					// e for interaction
					case 69:
						level.interactables.forEach(item => {
							if (playerNear(player, item)) {
								if (item instanceof Door) {
									// loadLevel(item.destination)
									clearScreen();
									level = item.destination;
								}
							}
						})
						break;
				}
			})
		}
	</script>
	<script type="text/javascript" src="level.js"></script>
	<script type="text/javascript" src="move.js"></script>
	<script type="text/javascript" src="draw.js"></script>

</body>
</html>